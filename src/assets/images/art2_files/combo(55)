YUI.add("notifications-menu-view",function(e){"use strict";e.namespace("Views")[this.name]=e.Base.create("notifications-menu-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.pollingFailed=!1,this.shouldFetchNotifs=!0,this.notifFilter=this.appContext.flipper.isFlipped("enable-notifications-2020")?[]:["group_topic_new","user_gallery_comment"].join(","),""===this.get("container").get("innerHTML")&&this.setContainerWithTemplate("notifications-menu"),this},loadState:function(){var t=this,i=this.appContext.getViewer();return this.appContext.getModel("person-notifications-models",i.nsid).then(function(n){if(t.set("personNotificationsModel",n),Date.now()-n.getValue("unseenLastFetchedTimestamp")>e.config.flickr.notifications.loading_count_refetch_delay)return n.remoteReadUnseenNotificationCount({id:i.nsid,filter:t.notifFilter},t.appContext).then(null,function(e){t.pollingFailed=!0})})},buildContainer:function(){var e=this.formatCount99(this.get("personNotificationsModel").getValue("unseenNotificationCount"));return this.setContainerWithTemplate("notifications-menu",{unseenNotificationCount:e}),this},activate:function(){var t,i=this,n=i.get("personNotificationsModel");i.unseenBadge=i.get("container").one(".c-notification-unseencount"),i.unseenCount=0,i.notifIcon=i.get("container").one(".c-notification-icon"),this.appContext.flipper.isFlipped("enable-notifications-2020")?(t=n.getValue("unseenNotificationCounts")||{}).total>0?(i.unseenBadge.set("text",i.formatCount99(t.total)),i.unseenBadge.removeClass("hidden")):i.unseenBadge.addClass("hidden"):0===n.getValue("unseenNotificationCount")?i.unseenBadge.addClass("hidden"):i.unseenBadge.removeClass("hidden"),e.on("notifications:closeNotificationsMenuClicked",function(e){i.droparound.close()}),this.registerEventHandler(this.get("container").on("click",i.openMenu.bind(i))),this.registerEventHandler(this.get("container").on("key",i.keyboardToggleMenu.bind(i),"down:13,32")),this.registerEventHandler(this.get("container").on("key",i.enterMenu.bind(i),"down:9,40")),i.pollForUnseenNotifs()},pollForUnseenNotifs:function(){this.pollIntervalId=setInterval(this.readUnseenNotifs.bind(this),e.config.flickr.notifications.polling_delay)},readUnseenNotifs:function(){var t=this,i=this.appContext.getViewer(),n=t.get("personNotificationsModel");n.remoteReadUnseenNotificationCount({id:i.nsid,filter:t.notifFilter},t.appContext).then(function(e){var i;t.shouldFetchNotifs=!0,n.setValue("initialNotificationsData",{}),t.appContext.flipper.isFlipped("enable-notifications-2020")?(i=n.getValue("unseenNotificationCounts")||{}).total>0?(t.unseenBadge.set("text",t.formatCount99(i.total)),t.unseenBadge.removeClass("hidden")):t.unseenBadge.addClass("hidden"):e!==t.unseenCount&&(t.unseenCount=e,0!==e?(t.unseenBadge.removeClass("hidden"),t.unseenBadge.set("text",t.formatCount99(e))):t.unseenBadge.addClass("hidden"))},function(i){clearInterval(t.pollIntervalId),t.pollingFailed||(t.pollingFailedTimeoutId=setTimeout(t.pollForUnseenNotifs.bind(t),e.config.flickr.notifications.polling_failure_timeout)),t.pollingFailed=!0})},openMenu:function(){this.revealNotifications()},keyboardToggleMenu:function(e){e.preventDefault(),!this.droparound||this.droparound.isClosed?this.revealNotifications():this.droparound.close()},enterMenu:function(e){var t=e.keyCode;if(9===t&&!e.shiftKey&&"true"===e.target.getAttribute("aria-expanded")||40===t){e.preventDefault();var i=this.droparound.get("container").one("div.notifs-droparound");if(i){var n=i.one("a.mail-icon");this.registerEventHandler(n.on("key",this.enterNotificationsList.bind(this),"down:9,40")),n.focus()}}},enterNotificationsList:function(e){var t=e.keyCode;(9===t&&!e.shiftKey||40===t)&&(e.preventDefault(),this.droparound.get("subview").findFocus.call(this,this.droparound.get("container").one("div.notifs-droparound").one("ul").one("li:not(.hidden)")))},revealNotifications:function(){var t,i=this.appContext.viewportData.getWidth(),n=this.appContext.viewportData.getHeight(),o=i>700?60:67,s=i>700?"":i-2+"px",a=n>1e3?"800px":n-200+"px";if(this.appContext.flipper.isFlipped("enable-notifications-2020")){var r=this.get("container").one(".c-notification-icon"),l=r.get("clientWidth"),d=i-r.get("offsetLeft")-l,c=i>700?450:i-2,u=Math.min(n-100,800);e.Analytics.sendClick("Notifications Bell: 2020"),d=i>700?Math.min(d,60):d,t=new e.Views["notifications-panel-view"]({appContext:this.appContext,width:this.appContext.flipper.isFlipped("enable-droparound-enhance-2021")?void 0:c,height:u}),this.droparound=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,anchorOffsetVertical:-4,anchorOffsetHorizontal:d-1,mirrorArrowAdjustment:d-1-l/2,showDropArrow:!0,contentPadding:0,anchorElement:r,subview:t,observePageResize:!0,positionFixed:!0,autoSizeToContent:!0,preventPageScrollOnScroll:!0,width:this.appContext.flipper.isFlipped("enable-droparound-enhance-2021")?450:void 0,arrowOffset:60}),this.droparound.show(),this.unseenBadge.addClass("hidden");var p=this.get("personNotificationsModel"),f=p.getValue("unseenNotificationCounts");p.setValue("unseenNotificationCounts",Object.assign(f,{total:0})),this.shouldFetchNotifs=!1}else e.Analytics.sendClick("Notifications Bell: Legacy"),(t=new e.Views["notifications-view"]({appContext:this.appContext,width:s,listHeight:a,shouldFetchNotifs:this.shouldFetchNotifs,notifFilter:this.notifFilter})).appContext=this.appContext,this.droparound=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,anchorOffsetVertical:-4,anchorOffsetHorizontal:o,mirrorArrowAdjustment:o-11,showDropArrow:!0,contentPadding:0,classList:"notifs-droparound no-border big-shadow",anchorElement:this.get("container").one(".c-notification-icon"),subview:t,observePageResize:!0,positionFixed:!0,autoSizeToContent:!0,preventPageScrollOnScroll:!0}),this.droparound.show(),this.unseenBadge.addClass("hidden"),this.shouldFetchNotifs=!1},formatCount99:function(e){return e>=100?"99+":e},destructor:function(){clearInterval(this.pollIntervalId),clearTimeout(this.pollingFailedTimeoutId)}})},"@VERSION@",{requires:["flickr-view","hermes-template-notifications-menu","fluid-droparound-view","notifications-view","notifications-panel-view"],langBundles:["notifications","common"]});YUI.add("hermes-template-person-card",function(n,l){var t=n.Template.Handlebars.revive({1:function(n,l,t,e,a){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t\t\t\t"+n.escapeExpression(n.lambda(null!=(o=null!=l?r(l,"person"):l)?r(o,"realname"):o,l))+"\n\t\t\t\t\t"+(null!=(o=r(t,"if").call(null!=l?l:n.nullContext||{},null!=l?r(l,"personLocation"):l,{name:"if",hash:{},fn:n.program(2,a,0),inverse:n.noop,data:a,loc:{start:{line:15,column:5},end:{line:15,column:37}}}))?o:"")+"\n"},2:function(n,l,t,e,a){return" - "},4:function(n,l,t,e,a){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(o=r(t,"each").call(null!=l?l:n.nullContext||{},null!=l?r(l,"photostream"):l,{name:"each",hash:{},fn:n.program(5,a,0),inverse:n.noop,data:a,loc:{start:{line:23,column:3},end:{line:29,column:12}}}))?o:""},5:function(n,l,t,e,a){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(o=r(t,"if").call(null!=l?l:n.nullContext||{},null!=l?r(l,"needsInterstitial"):l,{name:"if",hash:{},fn:n.program(6,a,0),inverse:n.program(8,a,0),data:a,loc:{start:{line:24,column:4},end:{line:28,column:11}}}))?o:""},6:function(n,l,t,e,a){var o,r,s=null!=l?l:n.nullContext||{},i=n.hooks.helperMissing,u=n.escapeExpression,c=n.lambda,p=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t\t\t<a href="'+u("function"==typeof(r=null!=(r=p(t,"url")||(null!=l?p(l,"url"):l))?r:i)?r.call(s,{name:"url",hash:{},data:a,loc:{start:{line:25,column:14},end:{line:25,column:21}}}):r)+'" title="'+u("function"==typeof(r=null!=(r=p(t,"title")||(null!=l?p(l,"title"):l))?r:i)?r.call(s,{name:"title",hash:{},data:a,loc:{start:{line:25,column:30},end:{line:25,column:39}}}):r)+'" width="'+u(c(null!=(o=null!=(o=null!=l?p(l,"sizes"):l)?p(o,"sq"):o)?p(o,"width"):o,l))+'" height="'+u(c(null!=(o=null!=(o=null!=l?p(l,"sizes"):l)?p(o,"sq"):o)?p(o,"height"):o,l))+'" style="background: url(https://combo.staticflickr.com/pw/images/spaceball.gif);" data-track="personCardRecentPhotosClick"></a>\n'},8:function(n,l,t,e,a){var o,r,s=null!=l?l:n.nullContext||{},i=n.hooks.helperMissing,u=n.escapeExpression,c=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t\t\t<a href="'+u("function"==typeof(r=null!=(r=c(t,"url")||(null!=l?c(l,"url"):l))?r:i)?r.call(s,{name:"url",hash:{},data:a,loc:{start:{line:27,column:14},end:{line:27,column:21}}}):r)+'" title="'+u("function"==typeof(r=null!=(r=c(t,"title")||(null!=l?c(l,"title"):l))?r:i)?r.call(s,{name:"title",hash:{},data:a,loc:{start:{line:27,column:30},end:{line:27,column:39}}}):r)+'" style="background: url('+u(n.lambda(null!=(o=null!=(o=null!=l?c(l,"sizes"):l)?c(o,"sq"):o)?c(o,"displayUrl"):o,l))+');" data-track="personCardRecentPhotosClick"></a>\n'},10:function(n,l,t,e,a){var o=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t<span class="tertiary">'+n.escapeExpression((o(t,"intlMessage")||l&&o(l,"intlMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlMessage",hash:{intlName:"person.NO_PHOTOS"},data:a,loc:{start:{line:31,column:26},end:{line:31,column:69}}}))+"</span>\n"},compiler:[8,">= 4.3.0"],main:function(n,l,t,e,a){var o,r,s=null!=l?l:n.nullContext||{},i=n.hooks.helperMissing,u=n.escapeExpression,c=n.lambda,p=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\n<div>\n\t<section>\n\t\t<div class="follow-subview">'+u((p(t,"outlet")||l&&p(l,"outlet")||i).call(s,null!=l?p(l,"follow-view"):l,{name:"outlet",hash:{},data:a,loc:{start:{line:4,column:30},end:{line:4,column:52}}}))+'</div>\n\n\t\t<div class="attribution">\n\t\t\t<a href="'+u(c(null!=(o=null!=l?p(l,"personURLS"):l)?p(o,"photostream"):o,l))+'" data-track="personCardAttributionNameClick">\n\t\t\t\t<h3 class="fade-out">'+u(c(null!=(o=null!=l?p(l,"person"):l)?p(o,"username"):o,l))+'</h3>\n\t\t\t</a>\n\t\t</div>\n\t\t<div class="info">\n\t\t\t<span class="secondary realname fade-out">\n'+(null!=(o=p(t,"if").call(s,null!=(o=null!=l?p(l,"person"):l)?p(o,"realname"):o,{name:"if",hash:{},fn:n.program(1,a,0),inverse:n.noop,data:a,loc:{start:{line:13,column:4},end:{line:16,column:11}}}))?o:"")+"\t\t\t\t"+u("function"==typeof(r=null!=(r=p(t,"personLocation")||(null!=l?p(l,"personLocation"):l))?r:i)?r.call(s,{name:"personLocation",hash:{},data:a,loc:{start:{line:17,column:4},end:{line:17,column:22}}}):r)+'\n\t\t\t</span>\n\t\t</div>\n\n\t\t<div class="recent-photos">\n'+(null!=(o=p(t,"if").call(s,null!=l?p(l,"photostream"):l,{name:"if",hash:{},fn:n.program(4,a,0),inverse:n.program(10,a,0),data:a,loc:{start:{line:22,column:2},end:{line:32,column:9}}}))?o:"")+'\t\t</div>\n\t</section>\n</div>\n\n<div class="links secondary">\n\t<a href="'+u(c(null!=(o=null!=l?p(l,"personURLS"):l)?p(o,"sendFlickrMail"):o,l))+'" data-track="personCardMessageClick">'+u((p(t,"intlMessage")||l&&p(l,"intlMessage")||i).call(s,{name:"intlMessage",hash:{intlName:"person.MESSAGE"},data:a,loc:{start:{line:38,column:77},end:{line:38,column:118}}}))+'</a>\n\t<a href="'+u(c(null!=(o=null!=l?p(l,"personURLS"):l)?p(o,"albums"):o,l))+'" data-track="personCardAlbumsClick">'+u((p(t,"intlMessage")||l&&p(l,"intlMessage")||i).call(s,{name:"intlMessage",hash:{intlName:"person.ALBUMS"},data:a,loc:{start:{line:39,column:68},end:{line:39,column:108}}}))+'</a>\n\t<a href="'+u(c(null!=(o=null!=l?p(l,"personURLS"):l)?p(o,"favorites"):o,l))+'" data-track="personCardFavesClick">'+u((p(t,"intlMessage")||l&&p(l,"intlMessage")||i).call(s,{name:"intlMessage",hash:{intlName:"person.FAVES"},data:a,loc:{start:{line:40,column:70},end:{line:40,column:109}}}))+'</a>\n\t<a class="align-right" href="'+u(c(null!=(o=null!=l?p(l,"personURLS"):l)?p(o,"profile"):o,l))+'" data-track="personCardProfileClick">'+u((p(t,"intlMessage")||l&&p(l,"intlMessage")||i).call(s,{name:"intlMessage",hash:{intlName:"common.ABOUT"},data:a,loc:{start:{line:41,column:90},end:{line:41,column:129}}}))+"</a>\n</div>\n"},useData:!0}),e={};n.Array.each([],function(l){var t=n.Template.get("hermes/"+l);t&&(e[l]=t)}),n.Template.register("hermes/person-card",function(l,a){return a=a||{},a.partials=a.partials?n.merge(e,a.partials):e,t(l,a)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("person-card-view",function(e){e.namespace("Views")[this.name]=e.Base.create("person-card-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.pathAlias=e.pathAlias,this.set("isActiveViewAgnostic",e.isActiveViewAgnostic||!1),""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},subviewConfig:{"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1}},loadState:function(){var t=this,s={contentType:7};return this.nsid?s.id=this.nsid:s.pathAlias=this.pathAlias,new e.FlickrPromise({person:this.appContext.getModel("person-models",s),photostream:this.appContext.getModel("photostream-models",s),personProfile:this.appContext.getModel("person-profile-models",s)}).then(function(e){return t.personModel=e.person,t.personLocation=e.personProfile.getValue("location"),e.photostream.getValue("photoPageList").getPage({page:1,perPage:5}).then(function(e){t.photostreamPhotos=e})},function(e){t.loadingError=!0,1===e.code&&"User not found"===e.message&&(t.badUser=!0)})},buildContainer:function(){var t,s;return this.loadingError?(s=this.badUser?'<span class="no-user">'+this.intlMessage({intlName:"person.NO_LONGER_ON_FLICKR"})+"</span>":'<span class="error-user">'+this.intlMessage({intlName:"person.ERROR_LOADING"})+"</span>",this.setContainerHTML(s)):(t=this.personModel.toJSON(),this.setContainerWithTemplate("person-card",{person:t,photostream:this.photostreamPhotos.map(function(e){return e.toJSON()}),personLocation:this.personLocation,personURLS:e.URLHelper.generatePersonUrls(this.personModel)})),this},activate:function(){var e=this.get("container"),t=e.one(".follow-view"),s=t.one(".relationship"),o=t.one(".relationship > .is-following"),n=e.one(".attribution");return s?o&&n.addClass("shorter"):n.addClass("full"),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-person-card","url-helper"],langBundles:["person","common"]});YUI.add("person-menu-view",function(e){var t=require("hermes-core/type-validator");e.namespace("Views")[this.name]=e.Base.create("person-menu-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.containerSelector=e.containerSelector,this.excludeSelectors=[".no-menu"].concat(e.excludeSelectors||[]),this.personSelector=".avatar.person, .photo-attribution .attribution-icon, .comment-icon.circle-icon a, .show-person-menu",this.dialogCache=[],this.currentDialog,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(""),this},toJSON:function(){return e.merge(this.get("user"))},activate:function(){this.registerEventHandler(e.one(this.containerSelector).delegate("click",this.onClickTarget.bind(this),this.personSelector,this))},onClickTarget:function(t){var n;this.shouldProcessTarget(t.target)&&(t.preventDefault(),t.halt(),n=t.target.ancestor().one(this.personSelector)||t.target.ancestor(this.personSelector)||t.target.ancestor("a"),this.createParamsAndManageState(n),e.rapidTracker.beacon(this.name,"personCardOpened"))},shouldProcessTarget:function(e){return null!==e.ancestor()&&!this.excludeSelectors.some(function(t){return e.ancestor().one(t)||e.ancestor(t)})},createParamsAndManageState:function(e){var t=this.getParams(e);this.createDialog(t,e)},getParams:function(e){var n,o={appContext:this.appContext,isActiveViewAgnostic:!0},r="";return(r=e.getData("person-nsid")||e.ancestor().getData("person-nsid"))||(0===(n=e.getAttribute("href")||e.ancestor().getAttribute("href")).indexOf("/photos")?r=n.replace("/photos/","").replace("/",""):0===n.indexOf("/groups/")&&(r=n.slice(n.lastIndexOf("/")+1))),o.disableRefreshOnRelationshipChange=e.hasClass("no-refresh"),t.nsid(r)?o.nsid=r:o.pathAlias=r,o.signature=r,o},createDialog:function(t,n){var o,r=this;this.fire("open"),e.fire("personMenuOpen",{anchorNode:n}),this.dialogCache.some(function(e){return e.key===t.signature&&(o=e.dialog,!0)}),o?o.set("anchorElement",n.ancestor().hasClass("comment-icon")?n.ancestor():n):((o=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,width:350,height:165,anchorOffsetHorizontal:0,observePageResize:!0,anchorElement:n.ancestor().hasClass("comment-icon")?n.ancestor():n,subview:new e.Views["person-card-view"](t)})).on("clickOverlay",function(e){r.nextElClicked=[e.clientX,e.clientY]}),o.on("closeDroparound",function(){setTimeout(function(){if(r.nextElClicked){var t,n=document.elementFromPoint(r.nextElClicked[0],r.nextElClicked[1]);n&&(t=e.one(n))&&r.personSelector.split(",").some(function(e){return t.hasClass(e.replace(".",""))})&&r.shouldProcessTarget(t)&&r.createParamsAndManageState(t),r.nextElClicked=null}},10)}),this.dialogCache.length>10&&this.dialogCache.shift(),this.dialogCache.push({key:t.signature,dialog:o})),o.on("closeDroparound",function(){e.fire("personMenuClose",{anchorNode:n})}),this.currentDialog=o,o.show()},closeDialog:function(){this.currentDialog&&(this.currentDialog.close(),e.fire("personMenuClose"))},destructor:function(){var t=this;this.currentDialog=null,e.Object.each(this.dialogCache,function(e){t.dialogCache[e]&&(t.dialogCache[e].destroy(),t.dialogCache[e]=null)}),this.dialogCache=[]}})},"@VERSION@",{requires:["flickr-promise","flickr-view","fluid-droparound-view","person-card-view"],langBundles:["person","common"]});YUI.add("hermes-template-group-card",function(n,l){var t=n.Template.Handlebars.revive({1:function(n,l,t,e,a){var r,o=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=o(t,"each").call(null!=l?l:n.nullContext||{},null!=l?o(l,"groupPool"):l,{name:"each",hash:{},fn:n.program(2,a,0),inverse:n.noop,data:a,loc:{start:{line:21,column:3},end:{line:31,column:12}}}))?r:""},2:function(n,l,t,e,a){var r,o,s=null!=l?l:n.nullContext||{},u=n.hooks.helperMissing,i=n.escapeExpression,c=n.lambda,p=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t\t\n\t\t\t\t<a href="'+i("function"==typeof(o=null!=(o=p(t,"url")||(null!=l?p(l,"url"):l))?o:u)?o.call(s,{name:"url",hash:{},data:a,loc:{start:{line:23,column:13},end:{line:23,column:20}}}):o)+'" title="'+i("function"==typeof(o=null!=(o=p(t,"title")||(null!=l?p(l,"title"):l))?o:u)?o.call(s,{name:"title",hash:{},data:a,loc:{start:{line:23,column:29},end:{line:23,column:38}}}):o)+'" width="'+i(c(null!=(r=null!=(r=null!=l?p(l,"sizes"):l)?p(r,"sq"):r)?p(r,"width"):r,l))+'" height="'+i(c(null!=(r=null!=(r=null!=l?p(l,"sizes"):l)?p(r,"sq"):r)?p(r,"height"):r,l))+'"\n'+(null!=(r=p(t,"if").call(s,null!=l?p(l,"needsInterstitial"):l,{name:"if",hash:{},fn:n.program(3,a,0),inverse:n.program(5,a,0),data:a,loc:{start:{line:24,column:4},end:{line:28,column:11}}}))?r:"")+"\t\t\t\t></a>\n\t\t\t\t\n"},3:function(n,l,t,e,a){return'\t\t\t\t\tclass="restricted"\n'},5:function(n,l,t,e,a){var r,o=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t\t\tstyle="background: url('+n.escapeExpression(n.lambda(null!=(r=null!=(r=null!=l?o(l,"sizes"):l)?o(r,"sq"):r)?o(r,"displayUrl"):r,l))+');"\n'},7:function(n,l,t,e,a){var r,o=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=o(t,"if").call(null!=l?l:n.nullContext||{},null!=l?o(l,"canAddPhotos"):l,{name:"if",hash:{},fn:n.program(8,a,0),inverse:n.program(10,a,0),data:a,loc:{start:{line:33,column:3},end:{line:38,column:10}}}))?r:""},8:function(n,l,t,e,a){var r,o=null!=l?l:n.nullContext||{},s=n.hooks.helperMissing,u=n.escapeExpression,i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t\t<p class="tertiary">'+u((i(t,"intlMessage")||l&&i(l,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"groups.BE_THE_FIRST"},data:a,loc:{start:{line:34,column:24},end:{line:34,column:70}}}))+'</p>\n\t\t\t\t<p class="tertiary"><a href="'+u(n.lambda(null!=(r=null!=l?i(l,"groupURLS"):l)?i(r,"photos"):r,l))+'">'+u((i(t,"intlMessage")||l&&i(l,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"groups.ADD_SOME_PHOTOS"},data:a,loc:{start:{line:35,column:55},end:{line:35,column:104}}}))+"</a></p>\n"},10:function(n,l,t,e,a){var r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t\t\t<p>"+n.escapeExpression((r(t,"intlMessage")||l&&r(l,"intlMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlMessage",hash:{intlName:"groups.NO_PHOTOS"},data:a,loc:{start:{line:37,column:7},end:{line:37,column:50}}}))+"</p>\n"},12:function(n,l,t,e,a){var r,o=n.escapeExpression,s=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t<a href="'+o(n.lambda(null!=(r=null!=l?s(l,"groupURLS"):l)?s(r,"admin"):r,l))+'">'+o((s(t,"intlMessage")||l&&s(l,"intlMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlMessage",hash:{intlName:"groups.ADMIN_LINK_LABEL"},data:a,loc:{start:{line:48,column:31},end:{line:48,column:81}}}))+"</a>\n"},14:function(n,l,t,e,a){var r,o=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=o(t,"if").call(null!=l?l:n.nullContext||{},null!=(r=null!=l?o(l,"group"):l)?o(r,"isModerator"):r,{name:"if",hash:{},fn:n.program(15,a,0),inverse:n.noop,data:a,loc:{start:{line:50,column:2},end:{line:52,column:9}}}))?r:""},15:function(n,l,t,e,a){var r,o=n.escapeExpression,s=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t<a href="'+o(n.lambda(null!=(r=null!=l?s(l,"groupURLS"):l)?s(r,"admin"):r,l))+'">'+o((s(t,"intlMessage")||l&&s(l,"intlMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlMessage",hash:{intlName:"groups.ADMIN_LINK_LABEL"},data:a,loc:{start:{line:51,column:32},end:{line:51,column:82}}}))+"</a>\n"},compiler:[8,">= 4.3.0"],main:function(n,l,t,e,a){var r,o=null!=l?l:n.nullContext||{},s=n.hooks.helperMissing,u=n.escapeExpression,i=n.lambda,c=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\n<div>\n\t<section>\n\t\t<div class="join-subview">\n\n\t\t\t'+u((c(t,"outlet")||l&&c(l,"outlet")||s).call(o,null!=l?c(l,"join-group-view"):l,{name:"outlet",hash:{},data:a,loc:{start:{line:6,column:3},end:{line:6,column:29}}}))+'\n\n\t\t</div>\n\n\t\t<div class="attribution">\n\t\t\t<a href="'+u(i(null!=(r=null!=l?c(l,"groupURLS"):l)?c(r,"about"):r,l))+'">\n\t\t\t\t<h3 class="fade-out">'+u((c(t,"renderTrustedMarkup")||l&&c(l,"renderTrustedMarkup")||s).call(o,null!=(r=null!=l?c(l,"group"):l)?c(r,"title"):r,{name:"renderTrustedMarkup",hash:{},data:a,loc:{start:{line:12,column:25},end:{line:12,column:60}}}))+'</h3>\n\t\t\t</a>\n\t\t</div>\n\t\t<div class="stats">\n\t\t\t<span class="secondary fade-out">'+u((c(t,"intlMessage")||l&&c(l,"intlMessage")||s).call(o,{name:"intlMessage",hash:{createdYear:null!=l?c(l,"createdYear"):l,intlName:"groups.CREATED_YEAR"},data:a,loc:{start:{line:16,column:36},end:{line:16,column:106}}}))+" - "+u((c(t,"intlMessage")||l&&c(l,"intlMessage")||s).call(o,{name:"intlMessage",hash:{updatedAgo:null!=l?c(l,"updatedAgo"):l,intlName:"groups.UPDATED_TIME_AGO"},data:a,loc:{start:{line:16,column:109},end:{line:16,column:181}}}))+'</span>\n\t\t</div>\n\n\t\t<div class="recent-photos">\n'+(null!=(r=c(t,"if").call(o,null!=l?c(l,"groupPool"):l,{name:"if",hash:{},fn:n.program(1,a,0),inverse:n.program(7,a,0),data:a,loc:{start:{line:20,column:2},end:{line:39,column:9}}}))?r:"")+'\t\t</div>\n\t</section>\n</div>\n\n<div class="links secondary">\n\t<a href="'+u(i(null!=(r=null!=l?c(l,"groupURLS"):l)?c(r,"photos"):r,l))+'">'+u((c(t,"intlMessage")||l&&c(l,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"groups.PHOTOS_LINK_LABEL"},data:a,loc:{start:{line:45,column:32},end:{line:45,column:83}}}))+'</a>\n\t<a href="'+u(i(null!=(r=null!=l?c(l,"groupURLS"):l)?c(r,"discussions"):r,l))+'">'+u((c(t,"intlMessage")||l&&c(l,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"groups.DISCUSSIONS_LINK_LABEL"},data:a,loc:{start:{line:46,column:37},end:{line:46,column:93}}}))+"</a>\n"+(null!=(r=c(t,"if").call(o,null!=(r=null!=l?c(l,"group"):l)?c(r,"isAdmin"):r,{name:"if",hash:{},fn:n.program(12,a,0),inverse:n.program(14,a,0),data:a,loc:{start:{line:47,column:1},end:{line:53,column:8}}}))?r:"")+"</div>"},useData:!0}),e={};n.Array.each([],function(l){var t=n.Template.get("hermes/"+l);t&&(e[l]=t)}),n.Template.register("hermes/group-card",function(l,a){return a=a||{},a.partials=a.partials?n.merge(e,a.partials):e,t(l,a)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("group-card-view",function(e){e.namespace("Views")[this.name]=e.Base.create("group-card-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.groupId=e.groupId,this.groupPathAlias=e.groupPathAlias,this.set("isActiveViewAgnostic",e.isActiveViewAgnostic||!1),""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},subviewConfig:{"join-group-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,shortLabels:!0,theme:"light"}},loadState:function(){var t=this,r=this.groupId;return new e.FlickrPromise({groupPool:this.appContext.getModel("group-pool-models",r),group:this.appContext.getModel("group-models",r),groupInfo:this.appContext.getModel("group-info-models",r)}).then(function(e){return t.groupModel=e.group,t.groupInfo=e.groupInfo,e.groupPool.getValue("photoPageList").getPage({page:1,perPage:5}).then(function(e){t.groupPhotos=e})},function(e){t.loadingError=!0})},buildContainer:function(){var t,r,o=!1;return this.loadingError?this.setContainerHTML('<span class="error-group">'+this.intlMessage({intlName:"groups.ERROR_LOADING"})+"</span>"):(t=this.groupModel.toJSON(),(o="disabled"!==(r=this.groupInfo.getValue("throttle")).mode&&r.remaining>0||"none"===r.mode)&&(o=t.isMember),this.setContainerWithTemplate("group-card",{group:t,groupPool:this.groupPhotos.map(function(e){return e.toJSON()}),canAddPhotos:o,groupURLS:e.URLHelper.generateGroupUrls(this.groupModel),createdYear:t.dateCreated.year(),updatedAgo:this.intlMessage(e.Handlebars.helpers._friendlySinceDate(t.latestGroupActivity,!0,!0))})),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",function(e){e.preventDefault()},".join")),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-group-card","url-helper","handlebars-helpers"],langBundles:["groups","relative-dates"]});YUI.add("group-menu-view",function(e){"use strict";e.namespace("Views")[this.name]=e.Base.create("group-menu-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.containerSelector=e.containerSelector,this.excludeSelectors=[".large",".no-menu"].concat(e.excludeSelectors||[]),this.groupSelector=".avatar.group",this.dialogCache=[],this.currentDialog,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(""),this},activate:function(){this.registerEventHandler(e.one(this.containerSelector).delegate("click",this.onClickTarget.bind(this),this.groupSelector,this))},onClickTarget:function(e){var t;this.shouldProcessTarget(e.target)&&(e.preventDefault(),e.halt(),t=e.target,this.createParamsAndManageState(t))},shouldProcessTarget:function(e){return null!==e.ancestor()&&!this.excludeSelectors.some(function(t){return e.ancestor().one(t)||e.ancestor(t)})},createParamsAndManageState:function(e){var t=this.getParams(e);this.createDialog(t,e)},getParams:function(e){var t={appContext:this.appContext,isActiveViewAgnostic:!0};return t.groupId=e.getData("group-nsid"),t.signature=t.groupId,t},createDialog:function(t,i){var n,o=this;this.fire("open"),e.fire("groupMenuOpen",{anchorNode:i}),this.dialogCache.some(function(e){return e.key===t.signature&&(n=e.dialog,!0)}),n?n.set("anchorElement",i):((n=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,width:350,height:165,observePageResize:!0,anchorElement:i,anchorOffsetHorizontal:4,subview:new e.Views["group-card-view"](t)})).on("clickOverlay",function(e){o.nextElClicked=[e.clientX,e.clientY]}),n.on("closeDroparound",function(){setTimeout(function(){if(o.nextElClicked){var t,i,n=document.elementFromPoint(o.nextElClicked[0],o.nextElClicked[1]);n&&(t=e.one(n),i=o.groupSelector.split(",").some(function(e){return t.hasClass(e.replace(".",""))}),t&&i&&o.shouldProcessTarget(t)&&o.createParamsAndManageState(t)),o.nextElClicked=null}},10)}),this.dialogCache.length>10&&this.dialogCache.shift(),this.dialogCache.push({key:t.signature,dialog:n})),n.on("closeDroparound",function(){e.fire("groupMenuClose",{anchorNode:i})}),this.currentDialog=n,n.show()},closeDialog:function(){this.currentDialog&&this.currentDialog.close()},destructor:function(){var t=this;this.currentDialog=null,e.Object.each(this.dialogCache,function(e){t.dialogCache[e]&&(t.dialogCache[e].destroy(),t.dialogCache[e]=null)}),this.dialogCache=null}})},"@VERSION@",{requires:["flickr-promise","flickr-view","fluid-droparound-view","group-card-view"],langBundles:["common"]});YUI.add("hermes-template-signup-interstitial",function(e,n){var t=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,n,t,a,s){var i=null!=n?n:e.nullContext||{},l=e.hooks.helperMissing,r=e.escapeExpression,o=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="signup-interstitial-body interstitial-fade">\n\t<div class="close-x"></div>\n\t<div class="body">\n\t\t<div class="logo"></div>\n\t\t<h3 class="signup-interstitial-message">'+r((o(t,"intlMessage")||n&&o(n,"intlMessage")||l).call(i,{name:"intlMessage",hash:{intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE_EXPLORE"},data:s,loc:{start:{line:5,column:42},end:{line:5,column:110}}}))+'</h3>\n\t\t<div><a href="/signup" class="butt large action signup-button">'+r((o(t,"intlMessage")||n&&o(n,"intlMessage")||l).call(i,{name:"intlMessage",hash:{intlName:"common.SIGN_UP_WITH_YAHOO"},data:s,loc:{start:{line:6,column:65},end:{line:6,column:117}}}))+'</a></div>\n\t\t<a href="/signin" class="signin-link">'+r((o(t,"intlMessage")||n&&o(n,"intlMessage")||l).call(i,{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:s,loc:{start:{line:7,column:40},end:{line:7,column:81}}}))+"</a>\n\t</div>\n</div>\n"},useData:!0}),a={};e.Array.each([],function(n){var t=e.Template.get("hermes/"+n);t&&(a[n]=t)}),e.Template.register("hermes/signup-interstitial",function(n,s){return s=s||{},s.partials=s.partials?e.merge(a,s.partials):a,t(n,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});